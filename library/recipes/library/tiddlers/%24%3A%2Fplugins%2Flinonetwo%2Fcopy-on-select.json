{"title":"$:/plugins/linonetwo/copy-on-select","description":"Copy what you are selecting inside the wiki into the clipboard","author":"LinOnetwo","core-version":">=5.1.22","plugin-type":"plugin","version":"0.0.1","list":"readme","dependents":"","type":"application/json","text":"{\"tiddlers\":{\"$:/plugins/linonetwo/copy-on-select/copy-on-select.html\":{\"title\":\"$:/plugins/linonetwo/copy-on-select/copy-on-select.html\",\"text\":\"<script type=\\\"application/javascript\\\">\\r\\n  // we won't do copy on select on text editor, otherwise you can't select and override text in the editor or text input\\r\\n  function checkIfElementIsEditor(element) {\\r\\n    if (!element || !element.nodeName) return false;\\r\\n    const isEditableElement = ['INPUT', 'TEXTAREA', 'BUTTON'].includes(element.nodeName);\\r\\n    if (!isEditableElement) {\\r\\n      if (!element.className || !element.className.toLowerCase) return false;\\r\\n    }\\r\\n    const isTextEditor = element.className.toLowerCase().includes('codemirror');\\r\\n\\r\\n    return isEditableElement || isTextEditor;\\r\\n  }\\r\\n  // if we start selection on editor, we prevent the following execution of this script\\r\\n  let copyOnSelectPreventNextCopy = false;\\r\\n  document.addEventListener('mousedown', function onMouseDown() {\\r\\n    const elementsUnderMouse = document.querySelectorAll(':hover');\\r\\n\\r\\n    if (!elementsUnderMouse || Array.from(elementsUnderMouse).some(checkIfElementIsEditor)) {\\r\\n      copyOnSelectPreventNextCopy = true;\\r\\n    }\\r\\n  });\\r\\n  // Copy on select, copy document selection when mouse button is up\\r\\n  document.addEventListener('mouseup', function onMouseUp() {\\r\\n    const elementsUnderMouse = document.querySelectorAll(':hover');\\r\\n\\r\\n    if (\\r\\n      copyOnSelectPreventNextCopy ||\\r\\n      !elementsUnderMouse ||\\r\\n      Array.from(elementsUnderMouse).some(checkIfElementIsEditor)\\r\\n    ) {\\r\\n      copyOnSelectPreventNextCopy = false;\\r\\n      return;\\r\\n    }\\r\\n    document.execCommand('copy');\\r\\n  });\\r\\n</script>\\r\\n\",\"type\":\"text/html\",\"created\":\"20200411065413157\",\"modified\":\"20200414150804034\",\"creator\":\"LinOnetwo\",\"tags\":\"$:/tags/RawMarkup\"},\"$:/plugins/linonetwo/copy-on-select/readme\":{\"title\":\"$:/plugins/linonetwo/copy-on-select/readme\",\"created\":\"20200414135748497\",\"modified\":\"20200602062349232\",\"creator\":\"LinOnetwo\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"!! 动机\\n\\n我已经习惯了用方便的[[Copy On Select|https://addons.mozilla.org/en-US/firefox/addon/copy-on-select]] Firefox 插件，现在到了 TiddlyWiki 里我经常还是以为选中了就复制了，然后黏贴到别的地方才发现其实并没有复制，很不习惯。\\n\\n所以我自己重新写了一个适配 TiddlyWiki 的选中即复制脚本。\\n\\n!! 用法\\n\\n选中编辑器、按钮等区域以外的任何文本都会直接复制。\\n\\n这个插件里的条件语句让它在编辑器等特殊区域内不会起作用，以免干扰「全选黏贴覆盖原有内容」等操作。\\r\\n\"}}}"}